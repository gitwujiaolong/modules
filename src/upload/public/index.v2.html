<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
    [data-role=ajaxUpload] {
      width: 80px;
      background-color: #6BC4FF;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      margin: 80px;
    }

    </style>
    <link rel='stylesheet' href='ajaxUpload.css'>
    <link rel='stylesheet' href='ajaxUpload-single.css'>
</head>
<body>
  <p>上传，兼容android4.2。</p>
  <div id='upload-btn' data-url='/upload' data-role='ajaxUpload'>上传图片</div>
  <div id='upload-btn-2' data-url='/upload' data-role='ajaxUpload' data-max-height='1136' data-max-width='630' data-max-size='100k' data-accept='image/gif,image/jpeg,image/png'>上传图片(限制，长宽100*100，文件大小<1M)</div>
  <div id='upload-btn-3' data-url='/upload' data-role='ajaxUpload' data-max-height='1136' data-width-height='1'>上传图片(指定比例)</div>
  <script src="ajaxUpload.v2.js"></script>
  <script src="XMLHttpRequest.js"></script>
  <script>
    var btn = document.querySelector('#upload-btn')
      , btn2 = document.querySelector('#upload-btn-2')
      , btn3 = document.querySelector('#upload-btn-3');

    btn.onprogress = function(p, e) {
      console.log(p)
      alert(p)
    }
    btn.onabort = function() {
      console.log('llll~~~~abort')
      alert('abort')
    }
    btn.onended = function(d) {
      console.log(d);
      alert('btn' + JSON.stringify(d));
    }

    btn2.onFileSizeError = function(name, size, minSize, maxSize) {
      console.log(name + ' ' + size + ' ' + minSize + ' ' + maxSize)
    }
    btn2.onImageSizeError = function(name, width, height) {
      console.log(name + ' ' + width + ' ' + height )
    }

    btn3.onImageSizeError = function(name, width, height) {
      console.log(arguments)
    }

  </script>
  <script type="text/javascript">
    window.onerror = function(msg, url, line, col, err) {
      msg = 'CUA:' + navigator.userAgent + '\nURL:' + location.href + '\nERR:' + (url || "local") + ':' + (line || -1) + ':' + (col || -1) + ' ' + msg + '\nSTACK:' + ((err && err.stack) || "");
      alert(msg);
    }
  </script>
</body>
</html>
